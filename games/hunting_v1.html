<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Animal Selection ‚Äì Drinking Game</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

  body {
    margin: 0;
    background: #222;
    height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-family: 'Press Start 2P', monospace;
    color: white;
  }

  #game {
    position: relative;
    width: 800px;
    height: 400px;
    border: 4px solid #000;
    background: linear-gradient(#87ceeb 60%, #2ecc71 40%);
    overflow: hidden;
    cursor: crosshair;
    margin-bottom: 20px;
  }

  .animal {
    position: absolute;
    width: 64px;
    height: 64px;
    font-size: 48px;
    transition: transform 0.3s;
    user-select: none;
    z-index: 1;
  }

  .dead::after {
    content: "‚úñ";
    position: absolute;
    color: red;
    font-size: 48px;
    top: 0;
    left: 18px;
  }

  #results {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    max-width: 760px;
    text-align: center;
    z-index: 10;
    pointer-events: none;
  }

  .popup {
    margin: 2px 0;
    font-size: 18px;
    color: white;
    background: rgba(0,0,0,0.8);
    padding: 4px 10px;
    border-radius: 6px;
    display: inline-block;
    animation: fadeOut 5s forwards; /* automatisch ausfaden */
  }

  @keyframes fadeOut {
    0% { opacity: 1; }
    80% { opacity: 1; }
    100% { opacity: 0; }
  }

  #instructions {
    font-size: 12px;
    color: #ddd;
    text-align: center;
    max-width: 800px;
  }
</style>
</head>
<body>
<div id="game">
  <div id="results"></div>
</div>
<div id="instructions">
  Click on an animal to select it. Each animal gives a random effect: "Drink 1", "Drink 2", "Drink 3", or "Safe".<br>
  Click anywhere else to start a new round with new animals.
</div>

<script>
const animals = [
  { name: 'Fox', emoji: 'ü¶ä' },
  { name: 'Bear', emoji: 'üêª' },
  { name: 'Wild Boar', emoji: 'üêó' },
  { name: 'Deer', emoji: 'ü¶å' },
  { name: 'Duck', emoji: 'ü¶Ü' }
];

const drinkTexts = ["Drink 1", "Drink 2", "Drink 3", "Safe"];
const game = document.getElementById("game");
const results = document.getElementById("results");

// Sounds
const shootSound = new Audio("https://actions.google.com/sounds/v1/impacts/metal_clang_and_rattle.ogg");
const drinkSound = new Audio("https://actions.google.com/sounds/v1/cartoon/slide_whistle_to_drum_hit.ogg");

function random(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

function isTooClose(x, y, positions, minDist = 80) {
  for (let pos of positions) {
    let dx = x - pos.x;
    let dy = y - pos.y;
    if (Math.sqrt(dx*dx + dy*dy) < minDist) return true;
  }
  return false;
}

function spawnAnimals() {
  // Remove existing animals but keep results
  game.querySelectorAll('.animal').forEach(el => el.remove());

  const count = random(5, 8);
  const positions = [];

  for (let i = 0; i < count; i++) {
    const a = animals[random(0, animals.length - 1)];

    let x, y;
    let attempts = 0;
    do {
      x = random(40, 720);
      y = random(40, 130);
      attempts++;
    } while (isTooClose(x, y, positions) && attempts < 50);
    positions.push({x, y});

    const el = document.createElement("div");
    el.className = "animal";
    el.style.left = x + "px";
    el.style.bottom = y + "px";
    el.textContent = a.emoji;
    el.dataset.name = a.name;
    el.onclick = (e) => shoot(e, el);
    game.appendChild(el);

    // Entry animation
    el.style.transform = "translateX(-120px)";
    setTimeout(() => el.style.transform = "translateX(0)", 120 * i);
  }
}

function shoot(e, el) {
  e.stopPropagation();
  if (el.classList.contains("dead")) return;

  el.classList.add("dead");
  shootSound.currentTime = 0;
  shootSound.play();

  const text = drinkTexts[random(0, drinkTexts.length - 1)];

  // Append result at the top, accumulating
  const popup = document.createElement("div");
  popup.className = "popup";
  popup.textContent = `${el.dataset.name}: ${text}`;
  results.appendChild(popup);

  if (text !== "Safe") {
    setTimeout(() => {
      drinkSound.currentTime = 0;
      drinkSound.play();
    }, 200);
  }
}

game.addEventListener("click", spawnAnimals);
spawnAnimals();
</script>
</body>
</html>